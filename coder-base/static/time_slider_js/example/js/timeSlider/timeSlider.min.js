
/*************************** Time Slider js **************************

timeSlider.js jQuery Plugin
http://d.hatena.ne.jp/kudakurage/

Depende: jquery-1.3.2
Version: 1.0
Created by: Kudakurage
Last Modified: 2009/12/19

Copyright (c) 2009 Kudakurage
Dual licensed under the MIT and GPL licenses.

**********************************************************************/
var timeSlider={};timeSlider.init= function(data){var ts={};ts.id=new Array();$(document).mousemove(function(e){ts.X=e.pageX;});ts.double=function(num){num=""+num;if(num.length==1){num="0"+num;};return num;};ts.result=function(num,id){if(ts.id[id].hForm[num]){ts.id[id].hForm[num].val(ts.double(Math.floor(ts.id[id].stepNow[num] / ts.id[id].minStepLen)));};if(ts.id[id].mForm[num]){ts.id[id].mForm[num].val(ts.double(ts.id[id].stepLen * (ts.id[id].stepNow[num] % ts.id[id].minStepLen)));};if(ts.id[id].hText[num]){ts.id[id].hText[num].text(ts.double(Math.floor(ts.id[id].stepNow[num] / ts.id[id].minStepLen)));};if(ts.id[id].mText[num]){ts.id[id].mText[num].text(ts.double(ts.id[id].stepLen * (ts.id[id].stepNow[num] % ts.id[id].minStepLen)));};};ts.sliding=function(num,id,form){if(form){var hour=ts.id[id].hForm[num].val();var minute=ts.id[id].mForm[num].val();if(hour > 24){hour="24";minute="0"}else if(hour < 0){hour="0";};if(minute < 0){minute="0";}else{if(hour==24){minute="0";};if(minute > 60){minute="59";};};if(hour.match(/^[0-9]+/) && minute.match(/^[0-9]+/)){ts.id[id].stepNow[num]=hour * ts.id[id].minStepLen + Math.round(minute / ts.id[id].stepLen);ts.id[id].hLeft[num]=ts.id[id].stepW * ts.id[id].stepNow[num];ts.id[id].percent[num]=ts.id[id].hLeft[num] / ts.id[id].maxLeft;}else{alert("Please Input Number Only.");};}else{ts.id[id].Left=ts.X - ts.id[id].minLeftX;if(ts.id[id].Left < 0){ts.id[id].percent[num]=0;ts.id[id].stepNow[num]=0;ts.id[id].hLeft[num]=0;}else if(ts.id[id].Left > ts.id[id].maxLeft){ts.id[id].percent[num]=1;ts.id[id].stepNow[num]=ts.id[id].step;ts.id[id].hLeft[num]=ts.id[id].maxLeft;}else{ts.id[id].stepNow[num]=Math.round(ts.id[id].Left / ts.id[id].stepW);ts.id[id].percent[num]=ts.id[id].Left / ts.id[id].maxLeft;ts.id[id].hLeft[num]=ts.id[id].stepW * ts.id[id].stepNow[num];};};ts.id[id].handleID[num].css({"left": ts.id[id].hLeft[num]+"px"});if(ts.id[id].type==2){if(ts.id[id].hLeft[1] >= ts.id[id].hLeft[0]){ts.id[id].sBar.css({"width":ts.id[id].hLeft[1]-ts.id[id].hLeft[0]+"px","left":ts.id[id].hLeft[0]+(ts.id[id].handleW / 2)+"px"});ts.id[id].noBar.css({"width":"0px"});}else{ts.id[id].sBar.css({"width":ts.id[id].barW+"px","left":"0px"});ts.id[id].noBar.css({"width":ts.id[id].hLeft[0]-ts.id[id].hLeft[1]+"px","left":ts.id[id].hLeft[1]+(ts.id[id].handleW / 2)+"px"});};};ts.result(num,id);$("#mX").val(ts.X);$("#pX").val(ts.id[id].hLeft[num]);$("#per").val(ts.id[id].percent[num]);$("#step").val(ts.id[id].stepNow[num]);if(ts.id[id].slidingBool){setTimeout(function(){ts.sliding(num,id,false);}, 30);};};ts.createHandle=function(handleNum,data,id){ts.id[id].handleID=[];ts.id[id].hForm=[];ts.id[id].mForm=[];ts.id[id].hText=[];ts.id[id].mText=[];ts.id[id].hSet=[];ts.id[id].mSet=[];ts.id[id].stepNow=[];ts.id[id].hLeft=[];ts.id[id].percent=[];time={"hour":false,"minute":false};for(i=0;i<handleNum;i++){num=i;ts.id[id].bar.append('<div class="handle" id="handle'+id+num+'" name="'+num+'"></div>');ts.id[id].handleID.push($(ts.id[id].sel+" #handle"+id+num));if(data[id].hourForm[num]){ts.id[id].hForm.push($(data[id].hourForm[num]));};if(data[id].minuteForm[num]){ts.id[id].mForm.push($(data[id].minuteForm[num]));};if(data[id].hourText[num]){ts.id[id].hText.push($(data[id].hourText[num]));};if(data[id].minuteText[num]){ts.id[id].mText.push($(data[id].minuteText[num]));};ts.id[id].hSet.push(data[id].setHour[num]);ts.id[id].mSet.push(data[id].setMinute[num]);ts.id[id].stepNow.push(ts.id[id].hSet[num] * ts.id[id].minStepLen + Math.round(ts.id[id].mSet[num] / ts.id[id].stepLen));ts.id[id].hLeft.push(ts.id[id].stepW * ts.id[id].stepNow[num]);ts.id[id].percent.push(ts.id[id].hLeft[num] / ts.id[id].maxLeft);ts.id[id].handleID[num].css({"position":"relative","width":ts.id[id].handleW+"px","height":ts.id[id].handleH+"px","top": -1*num*ts.id[id].handleH,"left":ts.id[id].hLeft[num]+"px","zIndex":"50","background":"url('"+ts.id[id].url+"images/"+ts.id[id].color+"/handle."+ts.id[id].image+"') no-repeat 0 0"});ts.result(num,id);ts.id[id].handleID[num].mousedown(function(e){ts.id[id].slidingBool=true;ts.id[id].handle.css({"zIndex":"50"});$(e.target).css({"zIndex":"100","opacity":"0.8"});ts.sliding($(e.target).attr("name"),id,false);});if(ts.id[id].hForm[num] && ts.id[id].mForm[num]){ts.id[id].hForm[num].change(function(e){for(i=0;i<handleNum;i++){if(ts.id[id].hForm[i].attr("id")==$(e.target).attr("id")){ts.sliding(i,id,true);};};});ts.id[id].mForm[num].change(function(e){for(i=0;i<handleNum;i++){if(ts.id[id].mForm[i].attr("id")==$(e.target).attr("id")){ts.sliding(i,id,true);};};});};};ts.id[id].handle=$(ts.id[id].sel+" .handle");if(handleNum==2){ts.id[id].handleID[0].css({"backgroundImage":"url('"+ts.id[id].url+"images/"+ts.id[id].color+"/handleStart."+ts.id[id].image+"')"});ts.id[id].handleID[1].css({"backgroundImage":"url('"+ts.id[id].url+"images/"+ts.id[id].color+"/handleEnd."+ts.id[id].image+"')"});ts.id[id].bar.append('<div class="selectedBar"></div>');ts.id[id].sBar=$(ts.id[id].sel+" .selectedBar");ts.id[id].sBar.css({"position":"relative","height":ts.id[id].handleH+"px","top":-2*ts.id[id].handleH+"px","background":"url('"+ts.id[id].url+"images/"+ts.id[id].color+"/selected."+ts.id[id].image+"') no-repeat center 15px"});ts.id[id].sBar.append('<div class="noSelectedBar"></div>');ts.id[id].noBar=$(ts.id[id].sel+" .noSelectedBar");ts.id[id].noBar.css({"position":"relative","width":"0px","height":ts.id[id].handleH+"px","top":"0px","background":"url('"+ts.id[id].url+"images/"+ts.id[id].color+"/noSelected."+ts.id[id].image+"') no-repeat center 15px"});if(ts.id[id].hLeft[1] > ts.id[id].hLeft[0]){ts.id[id].sBar.css({"width":ts.id[id].hLeft[1]-ts.id[id].hLeft[0]+"px","left":ts.id[id].hLeft[0]+(ts.id[id].handleW / 2)+"px"});}else{ts.id[id].sBar.css({"width":ts.id[id].barW+"px","left":"0px"});ts.id[id].noBar.css({"width":ts.id[id].hLeft[0]-ts.id[id].hLeft[1]+"px","left":ts.id[id].hLeft[1]+(ts.id[id].handleW / 2)+"px"});};};};for(id=0;id<data.length;id++){ts.id.push({});ts.id[id].barW=510;ts.id[id].handleW=28;ts.id[id].handleH=35;ts.id[id].stepLen=data[id].step;ts.id[id].minStepLen=60 / ts.id[id].stepLen;ts.id[id].step=24 * ts.id[id].minStepLen;ts.id[id].type=data[id].type;if(jQuery.browser.msie){ts.id[id].image="gif";}else{ts.id[id].image=data[id].image;};ts.id[id].color=data[id].color;ts.id[id].url=data[id].url;ts.id[id].sel=data[id].selector;ts.id[id].el=$(data[id].selector);ts.id[id].el.html('<div class="slider"><div class="bar"></div></div>');ts.id[id].slider=$(ts.id[id].sel+" .slider");ts.id[id].bar=$(ts.id[id].sel+" .bar");ts.id[id].minLeftX=ts.id[id].bar.position().left + 5 + (ts.id[id].handleW / 2);ts.id[id].maxLeftX=ts.id[id].barW + ts.id[id].minLeftX - ts.id[id].handleW -2;ts.id[id].maxLeft=ts.id[id].maxLeftX - ts.id[id].minLeftX;ts.id[id].stepW=ts.id[id].maxLeft / ts.id[id].step;ts.id[id].slider.css({"overflow":"hidden","width":"510px","height":"35px","padding":"15px 5px 0","background":"url('"+ts.id[id].url+"images/"+ts.id[id].color+"/slider."+ts.id[id].image+"') no-repeat 0 0"});ts.id[id].bar.css({"width":ts.id[id].barW+"px","height":ts.id[id].handleH+"px","background":"url('"+ts.id[id].url+"images/"+ts.id[id].color+"/bar."+ts.id[id].image+"') no-repeat center 15px"});ts.createHandle(ts.id[id].type,data,id);$(document).mouseup(function(){for(id=0;id<data.length;id++){ts.id[id].slidingBool=false;ts.id[id].handle.css({"opacity":"1"});};});};timeSlider=ts;};